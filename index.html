<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="utf-8">
    <title>JopaBot</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, user-scalable=no, viewport-fit=cover">
    <meta name="format-detection" content="telephone=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="MobileOptimized" content="176">
    <meta name="HandheldFriendly" content="True">
    <meta name="robots" content="noindex, nofollow">
    <script src="https://tg.dev/js/telegram-web-app.js"></script>
    <script>
      function setThemeClass() {
        document.documentElement.className = Telegram.WebApp.colorScheme;
      }
      Telegram.WebApp.onEvent('themeChanged', setThemeClass);
      setThemeClass();
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@200;500&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
        font-family: 'Montserrat', sans-serif;
        font-weight: 200;
        color: #e33a83;
        background: #f0bebe;
        /* color:  var(--tg-theme-text-color);
        background: var(--tg-theme-bg-color); */
        }

        #main {
            width: 100%;
            padding: 20px;
            text-align: center;
        }

        h1 {
            margin-top: 50px;
            margin-bottom: 0px;
        }

        img {
            width: 300px;
            margin: 10px auto;
        }

        p {
            width: 350px;
            font-size: large;
            font-family:'Lucida Sans Regular',  'Lucida Sans Unicode', Verdana;
            margin: 10px auto;
        }

        button {
            border: 5;
            border-radius: 100px;
            margin-top: 50px;
            height: 60px;
            width: 200px;
            margin: 30px auto;
            font-size: 20px;
            font-weight: 500;
            cursor: pointer;
            transition: all 500ms ease;
            color:#f0bebe;
            background-color: #e33a83;
            /* color:  var(--tg-theme-text-color);
            background: var(--tg-theme-bg-color); */
        }

        button:hover {
            background-color: #eca5a5;
            /* background: var(--tg-theme-bg-color); */
        }


        #form {
        display: none;
        text-align: center;
        }

        input {
            border: 2px solid rgb(223, 213, 213);
            border-radius: 5px;
            margin: 10px 5%;
            padding: 15px 10px;
            text-size-adjust: auto;
            height: 60px;
            width: 90%;
            font-size: 30px;
            font-family:Verdana, Geneva, Tahoma, sans-serif;
            background-color: rgb(255, 219, 219);
            background-size: auto;
            background-position: 0; 
            background-repeat: repeat;
            color:  var(&#45;&#45;tg-theme-text-color);
            background: var(&#45;&#45;tg-theme-bg-color);
            }

        input: focus {
        border-color: #db5d5d;
        }

    </style>
</head>

<body>
<div id = "main">
<h1>English & Tea</h1>
    <img src= "https://i.imgur.com/AhI8dyF.png">
    <p>Школа английского языка</p>
    <button id="buy">Бесплатная консультация</button>
</div>



<form id = "form">
    <input type ="text" placeholder="Имя" id ="user_name"><br>
    <input type ="email" placeholder="Email" id ="user_email" inputmode="email"><br>
    <input type ="phone" placeholder="Телефон" id ="user_phone" inputmode="tel"><br>
    <input type="date" name="Date" style="box-sizing: border-box;" id="Date" inputmode="numeric" min = "2000-02-12" max = "2030-02-12"><br>
    <input type="time" id="time" min="12:00" max="22:00" name="time"><br>
    <div id="error"></div>
    <button id="order">Оформить</button>
</form>

<script>
    let tg = window.Telegram.WebApp;
    let buy = document.getElementById("buy");
    let order = document.getElementById("order");

    buy.addEventListener("click", () => {
        document.getElementById("main").style.display = "none";
        document.getElementById("form").style.display = "block";
        document.getElementById("user_name").value = tg.initDataUnsafe.user.first_name;
        });

    order.addEventListener("click", () => {

        let name = document.getElementById("user_name").value;
        let email = document.getElementById("user_email").value;
        let phone = document.getElementById("user_phone").value;
        let date = document.getElementById("Date").value;
        let time = document.getElementById("time").value;

        if (name.length < 5) {
            document.getElementById("error").innerText = 'Ошибка в имени';
            return;
            }

        if (email.length < 5) {
            document.getElementById("error").innerText = 'Ошибка в email';
            return;
            }

         if (phone.length < 5) {
            document.getElementById("error").innerText = 'Ошибка в номере';
            return;
            }

        // if (date.length < 5) {
        //     document.getElementById("error").innerText = 'Ошибка в дате';
        //     return;
        //     }

        // if (time.length < 5) {
        //     document.getElementById("error").innerText = 'Ошибка во времени';
        //     return;
        //     }

        let data = {
            name: name,
            email: email,
            phone: phone,
            date: date,
            time: time
            }

        tg.sendData(JSON.stringify(data));
        });
</script>

<script>
        let currentDate = new Date();
        let stringDate = currentDate.toLocaleDateString();
        let day = stringDate.substring(0, 2);
        let month = stringDate.substring(3, 5);
        let year = stringDate.substring(6, 11);
        let nextMonth = "12";
        switch(month) {
            case ("01"): {
                nextMonth = "02"
                break
            }
            case ("02"): {
                nextMonth = "03"
                break
            }
            case ("03"): {
                nextMonth = "04"
                break
            }
            case ("04"): {
                nextMonth = "05"
                break
            }
            case ("05"): {
                nextMonth = "06"
                break
            }
            case ("06"): {
                nextMonth = "07"
                break
            }
            case ("07"): {
                nextMonth = "08"
                break
            }
            case ("08"): {
                nextMonth = "09"
                break
            }
            case ("09"): {
                nextMonth = "10"
                break
            }
            case ("10"): {
                nextMonth = "11"
                break
            }
            case ("11"): {
                nextMonth = "12"
                break
            }
            default: {
                nextMonth = "12"
            }
        };
        let minDate = year + "-" + month + "-" + day;
        let maxDate = year + "-" + nextMonth + "-" + day;
        document.getElementById('Date').valueAsDate = currentDate;
        document.getElementById('Date').setAttribute("min", minDate);
        document.getElementById('Date').setAttribute("max", maxDate);
</script>
</body>
</html>